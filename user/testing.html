<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge" http-equiv="X-UA-Compatible">
    <meta content="width=device-width, initial-scale=1" name="viewport">
    <title>Nvim documentation: testing</title>
    <link href="https://fonts.googleapis.com/css?family=Lato:400,700,900" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/3.0.0/normalize.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">
    <link href="/css/main.css" rel="stylesheet">
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
    
  </head>
  <body>
    <header class="navbar">
      <div class="container">
        <nav class="navbar">
          <div class="container-fluid">
            <div class="navbar-header">

              <a href="/" class="navbar-brand">
                <img src="/images/logo@2x.png" id="navbar-logo" alt="Neovim">
              </a>
            </div>
          </div>
        </nav>
      </div>
    </header>

    <div class="container">
      <h1>Nvim documentation: testing</h1>
<A NAME="top"></A>
<A HREF="index.html">main help file</A>

<HR>
<PRE>

*<A NAME="testing.txt"></A><B>testing.txt</B>*	Nvim


		  VIM REFERENCE MANUAL	  by Bram Moolenaar



Testing Vim and Vim <A HREF="usr_41.html#script">script</A>			*<A NAME="testing-support"></A><B>testing-support</B>*

Expression evaluation is explained in |<A HREF="eval.html">eval.txt</A>|.  This file goes into details
about <A HREF="editing.html#writing">writing</A> tests in Vim <A HREF="usr_41.html#script">script</A>.  This can be used for <A HREF="#testing">testing</A> Vim itself
and for <A HREF="#testing">testing</A> plugins.

1. Testing Vim				|<A HREF="#testing">testing</A>|
2. Test functions			|<A HREF="#test-functions-details">test-functions-details</A>|
3. Assert funtions			|<A HREF="#assert-functions-details">assert-functions-details</A>|

==============================================================================

1. Testing Vim						*<A NAME="testing"></A><B>testing</B>*

Vim can be tested after building <A HREF="motion.html#it">it</A>, usually with &quot;make test&quot;.
The tests are located in the directory &quot;src/testdir&quot;.

There are several types of tests added over time:
	test33.in		oldest, don't add any of these
	test_something.in	old style tests
	test_something.vim	new style tests


						*<A NAME="new-style-testing"></A><B>new-style-testing</B>*
New tests should be added <A HREF="motion.html#as">as</A> new style tests.  These use <A HREF="eval.html#functions">functions</A> such <A HREF="motion.html#as">as</A>
|<A HREF="#assert_equal()">assert_equal()</A>| to keep the test commands and the expected result in one
place.

						*<A NAME="old-style-testing"></A><B>old-style-testing</B>*
In some cases an old style test needs to be used.  E.g. when <A HREF="#testing">testing</A> Vim
without the |<A HREF="intro.html#+eval">+eval</A>| feature.

Find more information in the file src/testdir/README.txt.

==============================================================================

2. Test <A HREF="eval.html#functions">functions</A>				*<A NAME="test-functions-details"></A><B>test-functions-details</B>*


<A HREF="#test_garbagecollect_now()">test_garbagecollect_now()</A>			 *<A NAME="test_garbagecollect_now()"></A><B>test_garbagecollect_now()</B>*
		Like <A HREF="eval.html#garbagecollect()">garbagecollect()</A>, but executed right away.  This must
		only be called directly to avoid any structure to exist
		internally, and |<A HREF="eval.html#v:testing">v:testing</A>| must have been set before calling
		any function.

==============================================================================

3. Assert <A HREF="eval.html#functions">functions</A>				*<A NAME="assert-functions-details"></A><B>assert-functions-details</B>*



assert_beeps({cmd})					*<A NAME="assert_beeps()"></A><B>assert_beeps()</B>*
		Run {cmd} and add an error message to |<A HREF="eval.html#v:errors">v:errors</A>| if <A HREF="motion.html#it">it</A> does
		NOT produce a beep or visual bell.
		Also see |<A HREF="#assert_fails()">assert_fails()</A>|, |<A HREF="#assert_nobeep()">assert_nobeep()</A>| and
		|<A HREF="eval.html#assert-return">assert-return</A>|.


							*<A NAME="assert_equal()"></A><B>assert_equal()</B>*
assert_equal({expected}, {actual} [, {msg}])
		When {expected} and {actual} are not equal an error message is
		added to |<A HREF="eval.html#v:errors">v:errors</A>| and 1 is returned.  Otherwise zero is
		returned |<A HREF="eval.html#assert-return">assert-return</A>|.
		There is no automatic conversion, the <A HREF="eval.html#String">String</A> &quot;4&quot; is different
		from the <A HREF="eval.html#Number">Number</A> 4.  And the number 4 is different from the
		<A HREF="eval.html#Float">Float</A> 4.0.  The value of <A HREF="options.html#'ignorecase'">'ignorecase'</A> is not used here, <A HREF="change.html#case">case</A>
		always matters.
		When {msg} is omitted an error in the form &quot;Expected
		{expected} but got {actual}&quot; is produced.
		Example:
<B>	assert_equal('foo', 'bar')</B>
 		Will result in a <A HREF="eval.html#string">string</A> to be added to YXXYv:errors|:
<B><FONT color="#54A23D">	test.vim line 12: Expected 'foo' but got 'bar' </FONT></B>


							*<A NAME="assert_equalfile()"></A><B>assert_equalfile()</B>*
assert_equalfile({fname-one}, {fname-two})
		When the files {fname-one} and {fname-two} <A HREF="diff.html#do">do</A> not contain
		exactly the same text an error message is added to |<A HREF="eval.html#v:errors">v:errors</A>|.
		Also see |<A HREF="eval.html#assert-return">assert-return</A>|.
		When {fname-one} or {fname-two} does not exist the error will
		mention that.


assert_exception({error} [, {msg}])			*<A NAME="assert_exception()"></A><B>assert_exception()</B>*
		When <A HREF="eval.html#v:exception">v:exception</A> does not contain the <A HREF="eval.html#string">string</A> {error} an error
		message is added to |<A HREF="eval.html#v:errors">v:errors</A>|.  Also see |<A HREF="eval.html#assert-return">assert-return</A>|.
		This can be used to assert that a command throws an exception.
		Using the error number, followed by a colon, avoids problems
		with translations:
<B>			try</B>
<B>			  commandthatfails</B>
<B>			  call assert_false(1, 'command should have failed')</B>
<B>			catch</B>
<B>			  call assert_exception('E492:')</B>
<B>			endtry</B>


assert_fails({cmd} [, {error} [, {msg}]])			*<A NAME="assert_fails()"></A><B>assert_fails()</B>*
		Run {cmd} and add an error message to |<A HREF="eval.html#v:errors">v:errors</A>| if <A HREF="motion.html#it">it</A> does
		NOT produce an error.  Also see |<A HREF="eval.html#assert-return">assert-return</A>|.
		When {error} is given <A HREF="motion.html#it">it</A> must match in |<A HREF="eval.html#v:errmsg">v:errmsg</A>|.
		Note that beeping is not considered an error, and some failing
		commands only beep.  Use |<A HREF="#assert_beeps()">assert_beeps()</A>| for those.


assert_false({actual} [, {msg}])				*<A NAME="assert_false()"></A><B>assert_false()</B>*
		When {actual} is not false an error message is added to
		|<A HREF="eval.html#v:errors">v:errors</A>|, like with |<A HREF="#assert_equal()">assert_equal()</A>|.
		Also see |<A HREF="eval.html#assert-return">assert-return</A>|.
		A value is false when <A HREF="motion.html#it">it</A> is zero. When {actual} is not a
		number the assert fails.
		When {msg} is omitted an error in the form
		&quot;Expected False but got {actual}&quot; is produced.


assert_inrange({lower}, {upper}, {actual} [, {msg}])	 *<A NAME="assert_inrange()"></A><B>assert_inrange()</B>*
		This asserts number and |<A HREF="eval.html#Float">Float</A>| values.  When {actual}  is lower
		than {lower} or higher than {upper} an error message is added
		to |<A HREF="eval.html#v:errors">v:errors</A>|.  Also see |<A HREF="eval.html#assert-return">assert-return</A>|.
		When {msg} is omitted an error in the form
		&quot;Expected range {lower} - {upper}, but got {actual}&quot; is
		produced.


								*<A NAME="assert_match()"></A><B>assert_match()</B>*
assert_match({pattern}, {actual} [, {msg}])
		When {pattern} does not match {actual} an error message is
		added to |<A HREF="eval.html#v:errors">v:errors</A>|.  Also see |<A HREF="eval.html#assert-return">assert-return</A>|.

		{pattern} is used <A HREF="motion.html#as">as</A> with |=~|: The matching is always done
		like <A HREF="options.html#'magic'">'magic'</A> was set and <A HREF="options.html#'cpoptions'">'cpoptions'</A> is empty, no matter what
		the actual value of <A HREF="options.html#'magic'">'magic'</A> or <A HREF="options.html#'cpoptions'">'cpoptions'</A> is.

		{actual} is used <A HREF="motion.html#as">as</A> a <A HREF="eval.html#string">string</A>, automatic conversion applies.
		Use &quot;<A HREF="motion.html#^">^</A>&quot; and &quot;<A HREF="motion.html#$">$</A>&quot; to match with the start and end of the text.
		Use both to match the whole text.

		When {msg} is omitted an error in the form
		&quot;<A HREF="pattern.html#Pattern">Pattern</A> {pattern} does not match {actual}&quot; is produced.
		Example:
<B>	assert_match('^f.*o$', 'foobar')</B>
 		Will result in a <A HREF="eval.html#string">string</A> to be added to YXXYv:errors|:
<B><FONT color="#54A23D">	test.vim line 12: Pattern '^f.*o$' does not match 'foobar' </FONT></B>


assert_nobeep({cmd})					*<A NAME="assert_nobeep()"></A><B>assert_nobeep()</B>*
		Run {cmd} and add an error message to |<A HREF="eval.html#v:errors">v:errors</A>| if <A HREF="motion.html#it">it</A>
		produces a beep or visual bell.
		Also see |<A HREF="#assert_beeps()">assert_beeps()</A>|.


							*<A NAME="assert_notequal()"></A><B>assert_notequal()</B>*
assert_notequal({expected}, {actual} [, {msg}])
		The opposite of `assert_equal()`: add an error message to
		|<A HREF="eval.html#v:errors">v:errors</A>| when {expected} and {actual} are equal.
		Also see |<A HREF="eval.html#assert-return">assert-return</A>|.


							*<A NAME="assert_notmatch()"></A><B>assert_notmatch()</B>*
assert_notmatch({pattern}, {actual} [, {msg}])
		The opposite of `assert_match()`: add an error message to
		|<A HREF="eval.html#v:errors">v:errors</A>| when {pattern} matches {actual}.
		Also see |<A HREF="eval.html#assert-return">assert-return</A>|.


assert_report({msg})					*<A NAME="assert_report()"></A><B>assert_report()</B>*
		Report a test failure directly, using {msg}.
		Always returns one.


assert_true({actual} [, {msg}])				*<A NAME="assert_true()"></A><B>assert_true()</B>*
		When {actual} is not true an error message is added to
		|<A HREF="eval.html#v:errors">v:errors</A>|, like with |<A HREF="#assert_equal()">assert_equal()</A>|.
		Also see |<A HREF="eval.html#assert-return">assert-return</A>|.
		A value is |<A HREF="eval.html#TRUE">TRUE</A>| when <A HREF="motion.html#it">it</A> is a non-zero number or |<A HREF="eval.html#v:true">v:true</A>|.
		When {actual} is not a number or |<A HREF="eval.html#v:true">v:true</A>| the assert fails.
		When {msg} is omitted an error in the form &quot;Expected True but
		got {actual}&quot; is produced.


<A HREF="#top">top</A> - <A HREF="index.html">main help file</A>
</PRE>
    </div>

    <footer>
      <div class="container">
        Generated Wed Jul  7 05:28:19 UTC 2021 from <a href="https://github.com/neovim/neovim/commit/df33f30e8882b2bf692253d63f73fb602a13f888"><code>df33f30</code></a>.
      </div>
    </footer>
  </body>
</html>
